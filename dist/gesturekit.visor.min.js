/*! GestureKit Visor v1.0.0 http://gesturekit.com/ | Released under the Apache v2 License. */!function(a,b){"use strict";function c(a){var b;for(b in h)a.hasOwnProperty(b)||(a[b]=h[b]);return a}function d(a){return this._init(a),this}var e=a.document,f="https://i.cloudup.com/MqRsf26yX9-3000x3000.png",g=e.documentElement,h={size:60,container:e.body,drag:!0,snap:!0},i=function(){var a,b=/^(Webkit|Khtml|Moz|ms|O)(?=[A-Z])/,c=e.getElementsByTagName("script")[0].style;for(a in c)if(b.test(a))return"-"+a.match(b)[0].toLowerCase()+"-";return"WebkitOpacity"in c?"-webkit-":"KhtmlOpacity"in c?"-khtml-":""}();d.prototype._init=function(a){return this._options=c(a||{}),this.container=this._options.container,this.lastPoint={},this._motion=!1,this.currentOffset={x:2,y:60},this._createDisplay(),this._defineEvents(),this._options.drag&&this.drag(),this},d.prototype._createDisplay=function(){var a=["background-color: #909090;",'background-image: url("'+f+'");',"background-size: cover;","border-radius: 10px;","position: fixed;","top: 0;","left: 0;","z-index: 999;"];return this.display=e.createElement("canvas"),this.display.width=this.display.height=this._options.size,this.display.style.cssText=a.join(""),this.display.className="gk-visor-display",this.display.style[i+"transform"]="translate("+this.currentOffset.x+"px,"+this.currentOffset.y+"px)",this._ctx=this.display.getContext("2d"),this.container.appendChild(this.display),this},d.prototype._defineEvents=function(){var a=this;return b.on("gesturemotion",function(b){a._motion=!0,a._draw(b.touches)}),b.on("gestureend",function(){a._motion&&(a._motion=!1,a._finishDrawing())}),this},d.prototype.drag=function(){var a=this,c={x:0,y:0};return b.on("pointerstart",function(d){d.target===a.display&&(b.disable(),c.x=d.touches[0].pageX-a.currentOffset.x,c.y=d.touches[0].pageY-a.currentOffset.y)}),b.on("pointermove",function(b){if(b.target===a.display){b.preventDefault();var d=b.touches[0].pageX-c.x,e=b.touches[0].pageY-c.y;return a.display.style[i+"transform"]="translate("+d+"px,"+e+"px)",a.currentOffset.x=d,a.currentOffset.y=e,void 0}}),b.on("pointerend",function(c){c.target===a.display&&(a._options.snap&&a._snap(),b.enable())}),this},d.prototype._scalePoints=function(a,b){var c={},d={},e={},f=this.display,h=g.clientWidth,i=g.clientHeight,j=this.display.width,k=this.display.height;return h>i?(k=i*f.width/h,c.x=0,c.y=(f.height-k)/2):(j=h*f.height/i,c.y=0,c.x=(f.width-j)/2),e.x=h/j,e.y=i/k,d.x=a/e.x+c.x,d.y=b/e.y+c.y,d},d.prototype._draw=function(a){this.display.style.backgroundImage="none";var b,c,d,e=0,f=a.length,g=this._ctx;for(e;f>e;e+=1)c=a[e],b=c.identifier,d=this._scalePoints(c.pageX,c.pageY),this.lastPoint[b]&&(g.beginPath(),g.moveTo(this.lastPoint[b].x,this.lastPoint[b].y),g.lineTo(d.x,d.y),g.strokeStyle="#FFF",g.lineWidth=2,g.lineCap="round",g.stroke()),this.lastPoint[b]={x:d.x,y:d.y};return this},d.prototype._finishDrawing=function(){return this.lastPoint={},this._ctx.clearRect(0,0,this.display.width,this.display.height),this.display.style.backgroundImage='url("'+f+'")',this},d.prototype._snap=function(){var b=this,c=g.clientWidth,d=g.clientHeight,e=this.display.clientWidth,f=this.display.clientHeight,h=this.currentOffset.y,j=this.currentOffset.x;return this.currentOffset.x<e/2?j=2:this.currentOffset.x+e>c-e/2&&(j=c-e-2),this.currentOffset.y<f?h=2:this.currentOffset.y+f>d-f?h=d-f-2:j=this.currentOffset.x+e/2>c/2?c-e-2:2,this.currentOffset.y=h,this.currentOffset.x=j,this.display.style.transition=i+"transform 200ms ease-in-out",this.display.style[i+"transform"]="translate("+this.currentOffset.x+"px,"+this.currentOffset.y+"px)",a.setTimeout(function(){b.display.style.transition="none"},200),this},d.prototype.show=function(){return this._enabled=!0,this.display.style.display="block",this},d.prototype.hide=function(){return this._enabled=!1,this.display.style.display="none",this},"function"==typeof a.define&&void 0!==a.define.amd?a.define("Visor",[],function(){return d}):"undefined"!=typeof module&&void 0!==module.exports?module.exports=d:a.Visor=d}(this,this.gesturekit);