/*! GestureKit Visor v1.0.0 http://gesturekit.com/ | Released under the Apache v2 License. */!function(a,b){"use strict";function c(a){var b;for(b in e)a.hasOwnProperty(b)||(a[b]=e[b]);return a}function d(a){return this._init(a),this}var e={size:60,container:a.document.documentElement,drag:!0,snap:!0},f=function(){var a,b=/^(Webkit|Khtml|Moz|ms|O)(?=[A-Z])/,c=document.getElementsByTagName("script")[0].style;for(a in c)if(b.test(a))return"-"+a.match(b)[0].toLowerCase()+"-";return"WebkitOpacity"in c?"-webkit-":"KhtmlOpacity"in c?"-khtml-":""}();d.prototype._init=function(a){return this._options=c(a||{}),this.container=this._options.container,this.lastPoint={},this._motion=!1,this.currentOffset={x:2,y:2},this._createDisplay(),this._defineEvents(),this._options.drag&&this.drag(),this},d.prototype._createDisplay=function(){var a=["background-color: #909090;",'background-image: url("visor/assets/gk.png");',"background-size: cover;","border-radius: 10px;","position: fixed;","z-index: 999;"];return this.display=document.createElement("canvas"),this.display.width=this.display.height=this._options.size,this.display.style.cssText=a.join(""),this.display.style[f+"transform"]="translate("+this.currentOffset.x+"px,"+this.currentOffset.y+"px)",this._ctx=this.display.getContext("2d"),this.container.appendChild(this.display),this},d.prototype._defineEvents=function(){var a=this;return b.on("gesturemotion",function(b){a._motion=!0,a._draw(b.touches)}),b.on("gestureend",function(){a._motion&&(a._motion=!1,a._finishDrawing())}),this},d.prototype.drag=function(){var a=this,c={x:0,y:0};return b.on("pointerstart",function(d){d.target===a.display&&(b.disable(),c.x=d.touches[0].pageX-a.currentOffset.x,c.y=d.touches[0].pageY-a.currentOffset.y)}),b.on("pointermove",function(b){if(b.target===a.display){b.preventDefault();var d=b.touches[0].pageX-c.x,e=b.touches[0].pageY-c.y;return a.display.style[f+"transform"]="translate("+d+"px,"+e+"px)",a.currentOffset.x=d,a.currentOffset.y=e,void 0}}),b.on("pointerend",function(c){c.target===a.display&&(a._options.snap&&a._snap(),b.enable())}),this},d.prototype._scalePoints=function(a,b){var c={},d={},e={},f=this.display,g=this.container.clientWidth,h=this.container.clientHeight,i=this.display.width,j=this.display.height;return g>h?(j=h*f.width/g,c.x=0,c.y=(f.height-j)/2):(i=g*f.height/h,c.y=0,c.x=(f.width-i)/2),e.x=g/i,e.y=h/j,d.x=a/e.x+c.x,d.y=b/e.y+c.y,d},d.prototype._draw=function(a){this.display.style.backgroundImage="none";var b,c,d,e=0,f=a.length,g=this._ctx;for(e;f>e;e+=1)c=a[e],b=c.identifier,d=this._scalePoints(c.pageX,c.pageY),this.lastPoint[b]&&(g.beginPath(),g.moveTo(this.lastPoint[b].x,this.lastPoint[b].y),g.lineTo(d.x,d.y),g.strokeStyle="#FFF",g.lineWidth=3,g.lineCap="round",g.stroke()),this.lastPoint[b]={x:d.x,y:d.y};return this},d.prototype._finishDrawing=function(){return this.lastPoint={},this._ctx.clearRect(0,0,this.display.width,this.display.height),this.display.style.backgroundImage='url("visor/assets/gk.png")',this},d.prototype._snap=function(){var b=this,c=this.container.clientWidth,d=this.container.clientHeight,e=this.display.clientWidth,g=this.display.clientHeight,h=this.currentOffset.y,i=this.currentOffset.x;return this.currentOffset.x<e/2?i=2:this.currentOffset.x+e>c-e/2&&(i=c-e-2),this.currentOffset.y<g?h=2:this.currentOffset.y+g>d-g?h=d-g-2:i=this.currentOffset.x+e/2>c/2?c-e-2:2,this.currentOffset.y=h,this.currentOffset.x=i,this.display.style.transition=f+"transform 200ms ease-in-out",this.display.style[f+"transform"]="translate("+this.currentOffset.x+"px,"+this.currentOffset.y+"px)",a.setTimeout(function(){b.display.style.transition="none"},200),this},d.prototype.show=function(){return this._enabled=!0,this.display.style.display="block",this},d.prototype.hide=function(){return this._enabled=!1,this.display.style.display="none",this},"function"==typeof a.define&&void 0!==a.define.amd?a.define("Visor",[],function(){return d}):"undefined"!=typeof module&&void 0!==module.exports?module.exports=d:a.Visor=d}(this,gesturekit);